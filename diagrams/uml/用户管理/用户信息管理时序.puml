@startuml
actor User
participant MainActivity
participant UserProfileScreen
participant UserProfileViewModel
participant UserService
participant UserRepository

User -> MainActivity: 进入用户信息页面
MainActivity -> UserProfileScreen: 显示用户信息

UserProfileScreen -> UserProfileViewModel: getUserProfile()
UserProfileViewModel -> UserService: getUserById()
UserService -> UserRepository: findById()
UserRepository -> UserService: 返回用户信息
UserService -> UserProfileViewModel: 返回用户信息
UserProfileViewModel -> UserProfileScreen: 更新用户信息显示

User -> UserProfileScreen: 点击编辑按钮
UserProfileScreen -> UserProfileViewModel: enableEditMode()
UserProfileViewModel -> UserProfileScreen: 切换到编辑模式

User -> UserProfileScreen: 修改用户信息
User -> UserProfileScreen: 点击保存按钮
UserProfileScreen -> UserProfileViewModel: updateUserProfile()

UserProfileViewModel -> UserProfileViewModel: 校验表单数据
alt 表单数据无效
    UserProfileViewModel -> UserProfileScreen: 返回表单验证错误
    UserProfileScreen -> User: 显示错误提示
else 表单数据有效
    UserProfileViewModel -> UserService: updateUser()
    UserService -> UserRepository: save()
    UserRepository -> UserService: 返回更新后的用户信息
    UserService -> UserProfileViewModel: 返回更新后的用户信息

    UserProfileViewModel -> UserProfileScreen: 更新用户信息显示
    UserProfileViewModel -> UserProfileScreen: 切换到查看模式

    UserProfileScreen -> User: 显示更新成功提示
end

User -> UserProfileScreen: 点击注销按钮
UserProfileScreen -> UserProfileViewModel: logout()
UserProfileViewModel -> UserService: logout()
UserService -> UserService: 清除登录状态和本地token
UserService -> UserProfileViewModel: 返回注销成功
UserProfileViewModel -> MainActivity: 跳转到登录页面
MainActivity -> User: 显示登录页面
@enduml