@startuml
skinparam classAttributeIconSize 0

class RegistrationActivity {
    - registrationFragment: RegistrationFragment
    - registrationViewModel: RegistrationViewModel
    + onCreate()
    + onRegistrationSuccess()
    + onRegistrationFailure(errorMessage: String)
}

class RegistrationFragment {
    - registrationForm: RegistrationForm
    - registrationViewModel: RegistrationViewModel
    + onCreateView()
    + onSubmitRegistration()
    + showRegistrationSuccess()
    + showRegistrationFailure(errorMessage: String)
}

class RegistrationForm {
    - username: String
    - password: String
    - email: String
    + isValid(): Boolean
    + toUser(): User
}

class RegistrationViewModel {
    - registrationService: RegistrationService
    + submitRegistration(registrationForm: RegistrationForm)
    + onRegistrationSuccess()
    + onRegistrationFailure(errorMessage: String)
}

class RegistrationService {
    - userService: UserService
    - emailService: EmailService
    + register(user: User): Boolean
    - isUsernameUnique(username: String): Boolean
    - isEmailUnique(email: String): Boolean
}

class UserService {
    - userRepository: UserRepository
    + createUser(user: User): User
    + isUsernameUnique(username: String): Boolean
    + isEmailUnique(email: String): Boolean
}

class EmailService {
    + sendVerificationEmail(user: User): Boolean
}

class UserRepository {
    + save(user: User): User
    + findByUsername(username: String): User
    + findByEmail(email: String): User
}

class User {
    - id: Long
    - username: String
    - password: String
    - email: String
    - verified: Boolean
}

RegistrationActivity ..> RegistrationFragment
RegistrationActivity ..> RegistrationViewModel

RegistrationFragment ..> RegistrationForm
RegistrationFragment ..> RegistrationViewModel

RegistrationViewModel ..> RegistrationService

RegistrationService ..> UserService
RegistrationService ..> EmailService

UserService ..> UserRepository

UserRepository ..> User
@enduml